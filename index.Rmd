---
title: "This is the start my Portfolio"
author: "Jaco Prins"
date: "Spring 2023"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    orientation: columns
    vertical_layout: fill
---
```{r}
library(tidyverse)
library(spotifyr)
library(htmltools)
library(compmus)
```


Corpus
======================================
#### Single Song: The House of the rising Sun
The house of the rising sun is an old folk song. And like most folksongs the exact origins and author are unknown. The oldest published lyrics were written down by Robert Winslow Gordon, an academic collector of folk songs, in 1925. Throughout the last century many different covers of the song have been made with many different styles. I would like to look at a large collection of different covers and see if all these drastically different versions have things in common or whether I can group them into different types of covers (other than just the genre on which the cover is based).\


Homework - week 7
======================================
Column {data-width=200}{.sidebar}
------------------------------------------------------------------
### House of the Rising Sun
The 

Column {data-width=650}
--------------------------------------------------------------------

### Main graph
```{r}
house <- get_playlist_audio_features("", "3Bjr19sZK5leO42HHU5Uwo")

ggplot(house, aes(x= energy, y=valence, color=as.factor(time_signature))) +
  ggtitle("Analysis: Energy - Loudness - Time signature") +
  geom_point()+
  xlim(0,1) + ylim(0,1) +
  xlab("Energy") + 
  ylab("Valence") +
  labs(col="Time signature")

ggplot(house, aes(x=energy)) +
  ggtitle("Energy distribution over all the songs")+
  xlab("Energy") + 
  ylab("Count") +
  geom_histogram(binwidth = 0.1, color="white", fill="aquamarine3") 
```


Column {data-width=350}
---------------------------------------------------------------------

### Songs

```{r}

```

Homework - week 8
======================================
The chromagram of the song: House of the rising song version by River Matthew.\
All the chromagrams show high levels of A and D. This is not all to surprising as  the song is in the key of D (key=2 given by Spotify), D being the root note and A being the perfect fifth. The mode of the song is minor, which is confirmed best by the Chebsyshev chromogram, which show F and very little of F# (which would be major). 

```{r}

R_Matthew <-
  get_tidy_audio_analysis("3dF0So7E8GhS6ViCMvhzCb") |>
  select(segments) |>
  unnest(segments) |>
  select(start, duration, pitches)
```
Row  {.tabset}
-----------------------------------------------------------------------

### Euclidean
```{r}
R_Matthew |>
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) + ggtitle("Euclidean") +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### Chebyshev
```{r}
R_Matthew |>
  mutate(pitches = map(pitches, compmus_normalise, "chebyshev")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) + ggtitle("Chebyshev") +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()
```

### Manhattan
```{r}
R_Matthew |>
  mutate(pitches = map(pitches, compmus_normalise, "manhattan")) |>
  compmus_gather_chroma() |> 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) + ggtitle("Manhattan") +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c()

```



Example of the code
==============================================
#### Importing libraries
```{r, echo=TRUE}
library(tidyverse)
library(spotifyr)
```

#### Getting the first playlist and track audio features

```{r, echo=TRUE}
house <- get_playlist_audio_features("", "3Bjr19sZK5leO42HHU5Uwo")

ggplot(house, aes(x=energy)) +
  ggtitle("Energy distribution over all the songs")+
  xlab("Energy") + 
  ylab("Count") +
  geom_histogram(binwidth = 0.1, color="white", fill="aquamarine3") 
```
